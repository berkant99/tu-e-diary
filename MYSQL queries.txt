SELECT gr.student_id, DATE(gr.exam_date) as date, gr.grade, gr.semester, d.discipline, tchr.name, tchr.lastname, t.title FROM grades gr JOIN disciplines d ON gr.discipline_id = d.discipline_id JOIN teachers tchr ON gr.teacher_id = tchr.teacher_id JOIN titles t ON tchr.title_id = t.title_id WHERE gr.student_id = '18621414';
SELECT AVG(g.grade) as average, g.student_id, st.form_of_education, dense_rank() OVER (PARTITION BY SUBSTR(g.student_id, 1, 4), st.form_of_education ORDER BY average desc) AS rank FROM grades g JOIN students st ON g.student_id = st.facultyNumber WHERE g.grade > 2 GROUP BY g.student_id;